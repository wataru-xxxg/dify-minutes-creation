# 議事録作成ワークフロー

Dify で利用する議事録作成用ワークフローの定義ファイルです。音声ファイルを入力として、議事録のテキスト生成・JSON 変換・外部送信までを一連のフローで実行します。

## 概要

- **アプリ名**: 議事録作成ワークフロー
- **モード**: Workflow
- **バージョン**: 0.5.0
- **定義ファイル**: `議事録作成ワークフロー.yml`

## 機能

1. **音声ファイルの入力**  
   ユーザーがアップロードした音声ファイルを起点に処理を開始します。

2. **議事録のテキスト生成（LLM）**  
   Gemini 2.0 Flash を用いて、音声から以下の形式の議事録テキストを生成します。
   - **議事内容**: 主要な議題・トピック、主な発言、決定事項
   - **次のアクション**: タスク、担当者、期限

3. **JSON 形式への変換（LLM）**  
   生成した議事録テキストを、指定の JSON スキーマに変換します。
   - `title`: タイトル・日時
   - `agenda`: 議題ごとの `topic` / `remarks` / `decisions`
   - `nextActions`: タスクごとの `task` / `assignee` / `dueDate`

4. **外部 API への送信（HTTP）**  
   変換した JSON を HTTP POST で Google Apps Script の Web アプリ URL に送信します。

## ワークフロー構成

```
[ユーザー入力: 音声ファイル]
        ↓
[議事録作成: Gemini 2.0 Flash]
        ↓
[JSONデータ生成: Gemini 2.0 Flash]
        ↓
[HTTP リクエスト: POST → Google Apps Script]
        ↓
[出力: text, text_1]
```

## 前提条件・依存

- **Dify**: 本 YAML をインポートできる Dify 環境
- **マーケットプレイスプラグイン**: `langgenius/gemini` (0.7.8)
- **モデル**: Gemini 2.0 Flash（プロバイダ: `langgenius/gemini/google`）
- **外部連携**: HTTP ノードで指定されている Google Apps Script の Web アプリ URL が稼働していること  
  - 本番利用時は、この URL を自前の GAS エンドポイントに差し替えることを推奨します。

## インポート方法（Dify）

1. Dify のスタジオにログインする。
2. アプリ一覧などから「ワークフローをインポート」を選択する。
3. `議事録作成ワークフロー.yml` を指定してインポートする。
4. 必要に応じて以下を確認・変更する。
   - Gemini プラグインの設定と API キー
   - HTTP ノードの URL（Google Apps Script のデプロイ URL）
   - 各 LLM ノードのプロンプトやパラメータ（temperature 等）

## 出力

- **text**: 議事録作成ノードが出力した議事録テキスト
- **text_1**: JSONデータ生成ノードが出力した JSON 文字列

HTTP ノードは上記 JSON を Body として指定 URL に POST します。

## 注意事項

- 音声ファイルは「ユーザー入力」ノードで受け取るため、Dify 側で音声入力に対応した設定になっている必要があります。
- HTTP ノードの URL はサンプル用の Google Apps Script の可能性があります。運用時は自環境のエンドポイントに変更してください。
- リトライは有効（最大 3 回、間隔 100ms）です。

## ライセンス・利用

本ワークフローはプロジェクトのポリシーに従って利用してください。Gemini および Google Apps Script の利用規約もあわせて確認してください。
